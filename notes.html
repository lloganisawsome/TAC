<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="rightclick.css">
    <link rel="stylesheet" href="custom-cursor.css">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TAC Notes</title>

<style>
:root {
    --bg: #0a0a0b;
    --panel: #111113;
    --panel-hover: #1a1a1c;
    --accent: #22c55e;
    --accent-dim: rgba(34, 197, 94, 0.1);
    --muted: #71717a;
    --border: rgba(255,255,255,0.06);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

html, body {
    height: 100%;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--bg);
    color: #fff;
    font-size: 14px;
}

::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }

/* Sidebar */
.sidebar {
    position: fixed;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    width: 70px;
    background: var(--panel);
    border: 1px solid var(--accent);
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 12px 0;
    transition: all 0.3s ease;
    z-index: 1000;
    box-shadow: 0 0 20px var(--accent-dim);
}

.sidebar.collapsed {
    width: 0;
    padding: 0;
    border: none;
    margin-left: -10px;
    overflow: hidden;
}

.logo-container {
    margin-bottom: 16px;
    padding: 4px;
    transition: opacity 0.3s;
}

.sidebar.collapsed .logo-container {
    opacity: 0;
}

.logo {
    width: 62px;
    height: 62px;
    border-radius: 8px;
}

.nav-items {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    width: 100%;
    padding: 0 8px;
    transition: opacity 0.3s;
}

.sidebar.collapsed .nav-items {
    opacity: 0;
}

.nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 54px;
    height: 54px;
    border-radius: 10px;
    text-decoration: none;
    color: var(--accent);
    transition: all 0.2s ease;
    cursor: pointer;
}

.nav-item:hover {
    background: var(--accent-dim);
}

.nav-item.active {
    background: var(--accent-dim);
    border: 1px solid var(--accent);
}

.nav-item svg {
    width: 24px;
    height: 24px;
    margin-bottom: 2px;
}

.nav-item span {
    font-size: 9px;
    font-weight: 500;
}

.toggle-btn {
    position: fixed;
    left: 90px;
    top: 50%;
    transform: translateY(-50%);
    width: 20px;
    height: 36px;
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: 1001;
}

.toggle-btn:hover {
    background: var(--panel-hover);
    border-color: var(--accent);
}

.toggle-btn svg {
    width: 14px;
    height: 14px;
    color: #fff;
    transition: transform 0.3s ease;
}

.toggle-btn.collapsed {
    left: 10px;
}

.toggle-btn.collapsed svg {
    transform: rotate(180deg);
}

/* Main Content */
.main-content {
    margin-left: 100px;
    padding: 24px;
    transition: margin-left 0.3s ease;
    min-height: 100vh;
}

.main-content.expanded {
    margin-left: 24px;
}

.header {
    margin-bottom: 24px;
    text-align: center;
}

.header h1 {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 8px;
    color: var(--accent);
}

.header .subtitle {
    font-size: 14px;
    color: var(--muted);
}

/* Panel */
.panel {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
}

.panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    flex-wrap: wrap;
    gap: 12px;
}

.panel-title {
    font-size: 18px;
    font-weight: 600;
    margin: 0;
}

/* Notes Layout */
.notes-container {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 20px;
    max-width: 1400px;
    margin: 0 auto;
}

@media (max-width: 900px) {
    .notes-container {
        grid-template-columns: 1fr;
    }
}

/* Notes List */
.notes-list-panel {
    max-height: calc(100vh - 200px);
    display: flex;
    flex-direction: column;
}

.notes-list {
    flex: 1;
    overflow-y: auto;
    margin-bottom: 12px;
}

.note-item {
    padding: 12px 16px;
    background: rgba(255,255,255,0.02);
    border-radius: 8px;
    margin-bottom: 8px;
    border: 1px solid var(--border);
    cursor: pointer;
    transition: all 0.2s;
}

.note-item:hover {
    background: var(--panel-hover);
    border-color: var(--accent);
}

.note-item.active {
    background: var(--accent-dim);
    border-color: var(--accent);
}

.note-item-title {
    font-weight: 600;
    font-size: 14px;
    margin-bottom: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.note-item-preview {
    font-size: 12px;
    color: var(--muted);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.note-item-date {
    font-size: 10px;
    color: var(--muted);
    margin-top: 6px;
}

.notes-actions {
    display: flex;
    gap: 8px;
}

.btn {
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 6px;
}

.btn-primary {
    background: var(--accent);
    color: #000;
    flex: 1;
}

.btn-primary:hover {
    filter: brightness(1.1);
}

.btn-danger {
    background: rgba(239, 68, 68, 0.15);
    color: #ef4444;
    border: 1px solid rgba(239, 68, 68, 0.3);
}

.btn-danger:hover {
    background: rgba(239, 68, 68, 0.25);
}

.btn-secondary {
    background: var(--panel-hover);
    color: #fff;
    border: 1px solid var(--border);
}

.btn-secondary:hover {
    border-color: var(--accent);
}

/* Editor Panel */
.editor-panel {
    display: flex;
    flex-direction: column;
    max-height: calc(100vh - 200px);
}

/* Formatting Toolbar */
.formatting-toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    padding: 12px;
    background: rgba(255,255,255,0.02);
    border-radius: 8px;
    margin-bottom: 12px;
    border: 1px solid var(--border);
}

.toolbar-group {
    display: flex;
    gap: 2px;
    padding-right: 8px;
    margin-right: 8px;
    border-right: 1px solid var(--border);
}

.toolbar-group:last-child {
    border-right: none;
    margin-right: 0;
    padding-right: 0;
}

.toolbar-btn {
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 6px;
    background: transparent;
    color: var(--muted);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    font-size: 14px;
    font-weight: 600;
}

.toolbar-btn:hover {
    background: var(--accent-dim);
    color: var(--accent);
}

.toolbar-btn.active {
    background: var(--accent);
    color: #000;
}

.toolbar-btn svg {
    width: 16px;
    height: 16px;
}

.toolbar-select {
    padding: 6px 10px;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: var(--panel);
    color: #fff;
    font-size: 12px;
    cursor: pointer;
    outline: none;
}

.toolbar-select:hover {
    border-color: var(--accent);
}

.toolbar-select:focus {
    border-color: var(--accent);
}

/* Editor */
.editor-wrapper {
    flex: 1;
    position: relative;
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid var(--border);
}

#editor {
    width: 100%;
    height: 100%;
    min-height: 400px;
    background: rgba(255,255,255,0.02);
    color: #fff;
    padding: 20px;
    border: none;
    outline: none;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: 15px;
    line-height: 1.7;
    resize: none;
    overflow-y: auto;
}

#editor:focus {
    background: rgba(255,255,255,0.03);
}

#editor::placeholder {
    color: var(--muted);
}

/* Rich text styles */
#editor h1 { font-size: 28px; font-weight: 700; margin: 16px 0 8px; color: var(--accent); }
#editor h2 { font-size: 22px; font-weight: 600; margin: 14px 0 6px; }
#editor h3 { font-size: 18px; font-weight: 600; margin: 12px 0 4px; }
#editor ul, #editor ol { margin: 8px 0; padding-left: 24px; }
#editor li { margin: 4px 0; }
#editor blockquote { 
    border-left: 3px solid var(--accent); 
    padding-left: 16px; 
    margin: 12px 0;
    color: var(--muted);
    font-style: italic;
}
#editor code {
    background: rgba(255,255,255,0.1);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 13px;
}
#editor pre {
    background: rgba(0,0,0,0.3);
    padding: 16px;
    border-radius: 8px;
    overflow-x: auto;
    margin: 12px 0;
}
#editor pre code {
    background: none;
    padding: 0;
}
#editor a { color: var(--accent); text-decoration: underline; }
#editor hr { 
    border: none; 
    height: 1px; 
    background: var(--border); 
    margin: 20px 0; 
}
#editor table {
    border-collapse: collapse;
    width: 100%;
    margin: 12px 0;
}
#editor th, #editor td {
    border: 1px solid var(--border);
    padding: 8px 12px;
    text-align: left;
}
#editor th {
    background: rgba(255,255,255,0.05);
}

/* Status Bar */
.status-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    background: rgba(255,255,255,0.02);
    border-radius: 8px;
    margin-top: 12px;
    font-size: 12px;
    color: var(--muted);
}

.status-item {
    display: flex;
    align-items: center;
    gap: 6px;
}

.save-indicator {
    display: flex;
    align-items: center;
    gap: 6px;
}

.save-indicator.saving { color: #eab308; }
.save-indicator.saved { color: var(--accent); }

.save-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: currentColor;
}

/* Search */
.search-container {
    margin-bottom: 12px;
}

.search-input {
    width: 100%;
    padding: 10px 14px;
    padding-left: 36px;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: rgba(255,255,255,0.02);
    color: #fff;
    font-size: 13px;
    outline: none;
    transition: all 0.2s;
}

.search-input:focus {
    border-color: var(--accent);
    background: rgba(255,255,255,0.04);
}

.search-input::placeholder {
    color: var(--muted);
}

.search-wrapper {
    position: relative;
}

.search-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted);
    width: 16px;
    height: 16px;
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 40px 20px;
    color: var(--muted);
}

.empty-state svg {
    width: 48px;
    height: 48px;
    margin-bottom: 16px;
    opacity: 0.5;
}

.empty-state p {
    font-size: 14px;
    line-height: 1.6;
}

/* Word Count Modal */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s;
}

.modal-overlay.active {
    opacity: 1;
    visibility: visible;
}

.modal {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    max-width: 400px;
    width: 90%;
}

.modal-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 16px;
}

.modal-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.stat-item {
    background: rgba(255,255,255,0.02);
    padding: 16px;
    border-radius: 8px;
    text-align: center;
}

.stat-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--accent);
}

.stat-label {
    font-size: 12px;
    color: var(--muted);
    margin-top: 4px;
}

.modal-close {
    margin-top: 16px;
    width: 100%;
}

@media (max-width: 768px) {
    .main-content {
        margin-left: 24px;
    }
    
    .sidebar {
        display: none;
    }
    
    .toggle-btn {
        display: none;
    }
    
    .formatting-toolbar {
        overflow-x: auto;
        flex-wrap: nowrap;
    }
}
</style>
</head>
<body>

<!-- Sidebar -->
<aside class="sidebar" id="sidebar">
    <div class="logo-container">
        <img src="taclogos/green.png" alt="Logo" class="logo" id="logo">
    </div>

    <nav class="nav-items">
        <a href="index.html" class="nav-item">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            <span>Home</span>
        </a>

        <a href="chat.html" class="nav-item">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/>
                <circle cx="8" cy="10" r="1.5"/>
                <circle cx="12" cy="10" r="1.5"/>
                <circle cx="16" cy="10" r="1.5"/>
            </svg>
            <span>Chat</span>
        </a>

        <a href="notgames.html" class="nav-item">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M21.58 16.09l-1.09-7.66A3.996 3.996 0 0016.53 5H7.47a3.996 3.996 0 00-3.96 3.43l-1.09 7.66C2.2 17.63 3.39 19 4.94 19h0c.68 0 1.32-.27 1.8-.75L9 16h6l2.25 2.25c.48.48 1.13.75 1.8.75h0c1.55 0 2.75-1.37 2.53-2.91zM11 11H9v2H8v-2H6v-1h2V8h1v2h2v1zm4-1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm2 3c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"/>
            </svg>
            <span>Games</span>
        </a>

        <a href="phone.html" class="nav-item">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z"/>
            </svg>
            <span>Phone</span>
        </a>

        <a href="apps.html" class="nav-item">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"/>
            </svg>
            <span>All Apps</span>
        </a>


    </nav>
</aside>

<button class="toggle-btn" id="toggleBtn">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="15 18 9 12 15 6"/>
    </svg>
</button>

<!-- Main Content -->
<main class="main-content" id="mainContent">
    <div class="header">
        <h1>TAC Notes</h1>
        <p class="subtitle" id="welcomeText">Welcome back</p>
    </div>

    <div class="notes-container">
        <!-- Notes List Panel -->
        <div class="panel notes-list-panel">
            <div class="search-container">
                <div class="search-wrapper">
                    <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="m21 21-4.35-4.35"/>
                    </svg>
                    <input type="text" class="search-input" id="searchInput" placeholder="Search notes...">
                </div>
            </div>
            
            <div class="notes-list" id="notesList"></div>
            
            <div class="notes-actions">
                <button class="btn btn-primary" id="newNoteBtn">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    New Note
                </button>
                <button class="btn btn-danger" id="deleteNoteBtn">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Editor Panel -->
        <div class="panel editor-panel">
            <div class="formatting-toolbar" id="toolbar">
                <div class="toolbar-group">
                    <select class="toolbar-select" id="headingSelect">
                        <option value="p">Normal</option>
                        <option value="h1">Heading 1</option>
                        <option value="h2">Heading 2</option>
                        <option value="h3">Heading 3</option>
                    </select>
                </div>
                
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
                        <strong>B</strong>
                    </button>
                    <button class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
                        <em>I</em>
                    </button>
                    <button class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
                        <u>U</u>
                    </button>
                    <button class="toolbar-btn" data-command="strikeThrough" title="Strikethrough">
                        <s>S</s>
                    </button>
                </div>
                
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"/>
                        </svg>
                    </button>
                    <button class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"/>
                        </svg>
                    </button>
                    <button class="toolbar-btn" id="checklistBtn" title="Checklist">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="formatBlock" data-value="blockquote" title="Quote">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"/>
                        </svg>
                    </button>
                    <button class="toolbar-btn" id="codeBtn" title="Code Block">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/>
                        </svg>
                    </button>
                    <button class="toolbar-btn" id="linkBtn" title="Insert Link">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>
                        </svg>
                    </button>
                    <button class="toolbar-btn" data-command="insertHorizontalRule" title="Horizontal Line">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M4 11h16v2H4z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="justifyLeft" title="Align Left">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"/>
                        </svg>
                    </button>
                    <button class="toolbar-btn" data-command="justifyCenter" title="Align Center">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z"/>
                        </svg>
                    </button>
                    <button class="toolbar-btn" data-command="justifyRight" title="Align Right">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="toolbar-group">
                    <button class="toolbar-btn" data-command="undo" title="Undo (Ctrl+Z)">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/>
                        </svg>
                    </button>
                    <button class="toolbar-btn" data-command="redo" title="Redo (Ctrl+Y)">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="toolbar-group">
                    <button class="toolbar-btn" id="wordCountBtn" title="Word Count">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 18h12v-2H3v2zM3 6v2h18V6H3zm0 7h18v-2H3v2z"/>
                        </svg>
                    </button>
                    <button class="toolbar-btn" id="fullscreenBtn" title="Fullscreen">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div class="editor-wrapper">
                <div id="editor" contenteditable="true" placeholder="Start writing your note..."></div>
            </div>
            
            <div class="status-bar">
                <div class="status-item">
                    <span id="wordCount">0 words</span>
                    <span>•</span>
                    <span id="charCount">0 characters</span>
                </div>
                <div class="save-indicator saved" id="saveIndicator">
                    <span class="save-dot"></span>
                    <span id="saveText">Saved</span>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Word Count Modal -->
<div class="modal-overlay" id="wordCountModal">
    <div class="modal">
        <h3 class="modal-title">Document Statistics</h3>
        <div class="modal-stats">
            <div class="stat-item">
                <div class="stat-value" id="modalWords">0</div>
                <div class="stat-label">Words</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="modalChars">0</div>
                <div class="stat-label">Characters</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="modalCharsNoSpace">0</div>
                <div class="stat-label">Characters (no spaces)</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="modalParagraphs">0</div>
                <div class="stat-label">Paragraphs</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="modalSentences">0</div>
                <div class="stat-label">Sentences</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="modalReadTime">0 min</div>
                <div class="stat-label">Read Time</div>
            </div>
        </div>
        <button class="btn btn-primary modal-close" id="closeModal">Close</button>
    </div>
</div>

<!-- Firebase SDK -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
import { getDatabase, ref, get, update } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyBQslLAFRlIRJqsiJ2WWeTNslO067bzKYM",
    authDomain: "taclogin-ab38e.firebaseapp.com",
    databaseURL: "https://taclogin-ab38e-default-rtdb.firebaseio.com",
    projectId: "taclogin-ab38e",
    storageBucket: "taclogin-ab38e.firebasestorage.app",
    messagingSenderId: "937853298051",
    appId: "1:937853298051:web:119ccc7b5499514bd442b6"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Theme Colors
const themeColors = {
    green: { primary: '#22c55e', dim: 'rgba(34, 197, 94, 0.1)', shadow: 'rgba(34, 197, 94, 0.15)' },
    blue: { primary: '#3b82f6', dim: 'rgba(59, 130, 246, 0.1)', shadow: 'rgba(59, 130, 246, 0.15)' },
    red: { primary: '#ef4444', dim: 'rgba(239, 68, 68, 0.1)', shadow: 'rgba(239, 68, 68, 0.15)' },
    cyan: { primary: '#06b6d4', dim: 'rgba(6, 182, 212, 0.1)', shadow: 'rgba(6, 182, 212, 0.15)' },
    pink: { primary: '#ec4899', dim: 'rgba(236, 72, 153, 0.1)', shadow: 'rgba(236, 72, 153, 0.15)' },
    purple: { primary: '#8b5cf6', dim: 'rgba(139, 92, 246, 0.1)', shadow: 'rgba(139, 92, 246, 0.15)' },
    yellow: { primary: '#eab308', dim: 'rgba(234, 179, 8, 0.1)', shadow: 'rgba(234, 179, 8, 0.15)' },
    orange: { primary: '#f97316', dim: 'rgba(249, 115, 22, 0.1)', shadow: 'rgba(249, 115, 22, 0.15)' },
    white: { primary: '#ffffff', dim: 'rgba(255, 255, 255, 0.1)', shadow: 'rgba(255, 255, 255, 0.15)' },
    whiteout: { primary: '#ffffff', dim: 'rgba(255, 255, 255, 0.05)', shadow: 'rgba(255, 255, 255, 0.1)' }
};

function applyTheme() {
    const theme = localStorage.getItem('theme') || 'green';
    const colors = themeColors[theme] || themeColors.green;

    document.documentElement.style.setProperty('--accent', colors.primary);
    document.documentElement.style.setProperty('--accent-dim', colors.dim);

    const logo = document.getElementById('logo');
    if (logo) logo.src = `taclogos/${theme}.png`;

    const sidebar = document.getElementById('sidebar');
    if (sidebar) sidebar.style.boxShadow = `0 0 20px ${colors.shadow}`;
}

applyTheme();

window.addEventListener('storage', (e) => {
    if (e.key === 'theme') {
        applyTheme();
    }
});

// Sidebar Toggle
const sidebar = document.getElementById('sidebar');
const toggleBtn = document.getElementById('toggleBtn');
const mainContent = document.getElementById('mainContent');

toggleBtn.addEventListener('click', () => {
    sidebar.classList.toggle('collapsed');
    toggleBtn.classList.toggle('collapsed');
    mainContent.classList.toggle('expanded');
});

// Get username from localStorage
let username = localStorage.getItem('lastLoggedInUser') || '';
let notes = {};
let activeNoteKey = null;
let searchQuery = '';

const editor = document.getElementById('editor');
const notesList = document.getElementById('notesList');
const searchInput = document.getElementById('searchInput');
const welcomeText = document.getElementById('welcomeText');

// Set welcome text
if (username) {
    welcomeText.textContent = `Welcome back, ${username}`;
    loadNotes();
} else {
    welcomeText.textContent = 'Please log in first';
    notesList.innerHTML = `
        <div class="empty-state">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
            <p>No user found. Please log in from the main page first.</p>
        </div>
    `;
}

// Search functionality
searchInput.addEventListener('input', (e) => {
    searchQuery = e.target.value.toLowerCase();
    renderNotes();
});

document.getElementById('newNoteBtn').addEventListener('click', createNewNote);
document.getElementById('deleteNoteBtn').addEventListener('click', deleteNote);

function createNewNote() {
    if (!username) return;
    const key = Date.now().toString();
    notes[key] = {
        title: 'New Note',
        content: '',
        created: new Date().toISOString(),
        updated: new Date().toISOString()
    };
    activeNoteKey = key;
    renderNotes();
    loadNoteIntoEditor(key);
    editor.focus();
    saveNote();
}

async function loadNotes() {
    if (!username) return;
    const snapshot = await get(ref(db, 'notes/' + username));
    notes = snapshot.val() || {};
    
    // Sort by updated date
    const sortedKeys = Object.keys(notes).sort((a, b) => {
        const dateA = notes[a].updated || notes[a].created || a;
        const dateB = notes[b].updated || notes[b].created || b;
        return dateB.localeCompare(dateA);
    });
    
    if (sortedKeys.length > 0) {
        activeNoteKey = sortedKeys[0];
        loadNoteIntoEditor(activeNoteKey);
    }
    renderNotes();
}

function renderNotes() {
    if (!username) return;
    
    const filteredKeys = Object.keys(notes).filter(key => {
        if (!searchQuery) return true;
        const note = notes[key];
        return note.title.toLowerCase().includes(searchQuery) || 
               (note.content && note.content.toLowerCase().includes(searchQuery));
    });
    
    // Sort by updated date
    filteredKeys.sort((a, b) => {
        const dateA = notes[a].updated || notes[a].created || a;
        const dateB = notes[b].updated || notes[b].created || b;
        return dateB.localeCompare(dateA);
    });
    
    if (filteredKeys.length === 0) {
        notesList.innerHTML = `
            <div class="empty-state">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                </svg>
                <p>${searchQuery ? 'No notes found matching your search.' : 'No notes yet. Create your first note!'}</p>
            </div>
        `;
        return;
    }
    
    notesList.innerHTML = '';
    filteredKeys.forEach(key => {
        const note = notes[key];
        const div = document.createElement('div');
        div.className = `note-item ${key === activeNoteKey ? 'active' : ''}`;
        
        // Get plain text preview
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = note.content || '';
        const plainText = tempDiv.textContent || tempDiv.innerText || '';
        const preview = plainText.substring(0, 60) + (plainText.length > 60 ? '...' : '');
        
        // Format date
        const date = note.updated || note.created;
        let dateStr = '';
        if (date) {
            const d = new Date(date);
            const now = new Date();
            const diff = now - d;
            if (diff < 60000) dateStr = 'Just now';
            else if (diff < 3600000) dateStr = `${Math.floor(diff/60000)} min ago`;
            else if (diff < 86400000) dateStr = `${Math.floor(diff/3600000)} hours ago`;
            else dateStr = d.toLocaleDateString();
        }
        
        div.innerHTML = `
            <div class="note-item-title">${note.title || 'Untitled'}</div>
            <div class="note-item-preview">${preview || 'Empty note'}</div>
            ${dateStr ? `<div class="note-item-date">${dateStr}</div>` : ''}
        `;
        
        div.onclick = () => {
            activeNoteKey = key;
            loadNoteIntoEditor(key);
            renderNotes();
        };
        
        notesList.appendChild(div);
    });
}

function loadNoteIntoEditor(key) {
    if (!notes[key]) return;
    editor.innerHTML = notes[key].content || '';
    updateWordCount();
}

function updateSaveIndicator(status) {
    const indicator = document.getElementById('saveIndicator');
    const text = document.getElementById('saveText');
    
    indicator.classList.remove('saving', 'saved');
    indicator.classList.add(status);
    text.textContent = status === 'saving' ? 'Saving...' : 'Saved';
}

async function saveNote() {
    if (!activeNoteKey || !username) return;
    
    updateSaveIndicator('saving');
    
    const content = editor.innerHTML;
    notes[activeNoteKey].content = content;
    
    // Extract title from first line
    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = content;
    const firstLine = tempDiv.textContent?.split('\n')[0] || '';
    notes[activeNoteKey].title = firstLine.substring(0, 50) || 'Untitled';
    notes[activeNoteKey].updated = new Date().toISOString();
    
    await update(ref(db, 'notes/' + username), notes);
    
    updateSaveIndicator('saved');
    renderNotes();
}

// Autosave
let saveTimeout;
editor.addEventListener('input', () => {
    updateWordCount();
    clearTimeout(saveTimeout);
    saveTimeout = setTimeout(saveNote, 500);
});

async function deleteNote() {
    if (!activeNoteKey || !username) return;
    if (!confirm('Are you sure you want to delete this note?')) return;
    
    delete notes[activeNoteKey];
    
    const keys = Object.keys(notes);
    activeNoteKey = keys.length > 0 ? keys[0] : null;
    
    await update(ref(db, 'notes/' + username), notes);
    
    renderNotes();
    
    if (activeNoteKey) {
        loadNoteIntoEditor(activeNoteKey);
    } else {
        editor.innerHTML = '';
    }
}

// Formatting Toolbar
document.querySelectorAll('.toolbar-btn[data-command]').forEach(btn => {
    btn.addEventListener('click', () => {
        const command = btn.dataset.command;
        const value = btn.dataset.value || null;
        document.execCommand(command, false, value);
        editor.focus();
    });
});

document.getElementById('headingSelect').addEventListener('change', (e) => {
    document.execCommand('formatBlock', false, e.target.value);
    editor.focus();
});

document.getElementById('linkBtn').addEventListener('click', () => {
    const url = prompt('Enter URL:');
    if (url) {
        document.execCommand('createLink', false, url);
    }
    editor.focus();
});

document.getElementById('codeBtn').addEventListener('click', () => {
    const selection = window.getSelection();
    if (selection.rangeCount > 0) {
        const range = selection.getRangeAt(0);
        const code = document.createElement('code');
        code.appendChild(range.extractContents());
        range.insertNode(code);
    }
    editor.focus();
});

document.getElementById('checklistBtn').addEventListener('click', () => {
    const checkbox = '☐ ';
    document.execCommand('insertText', false, checkbox);
    editor.focus();
});

// Word Count
function updateWordCount() {
    const text = editor.innerText || '';
    const words = text.trim() ? text.trim().split(/\s+/).length : 0;
    const chars = text.length;
    
    document.getElementById('wordCount').textContent = `${words} words`;
    document.getElementById('charCount').textContent = `${chars} characters`;
}

// Word Count Modal
document.getElementById('wordCountBtn').addEventListener('click', () => {
    const text = editor.innerText || '';
    const words = text.trim() ? text.trim().split(/\s+/).length : 0;
    const chars = text.length;
    const charsNoSpace = text.replace(/\s/g, '').length;
    const paragraphs = text.split(/\n\n+/).filter(p => p.trim()).length || 0;
    const sentences = text.split(/[.!?]+/).filter(s => s.trim()).length || 0;
    const readTime = Math.ceil(words / 200);
    
    document.getElementById('modalWords').textContent = words;
    document.getElementById('modalChars').textContent = chars;
    document.getElementById('modalCharsNoSpace').textContent = charsNoSpace;
    document.getElementById('modalParagraphs').textContent = paragraphs;
    document.getElementById('modalSentences').textContent = sentences;
    document.getElementById('modalReadTime').textContent = `${readTime} min`;
    
    document.getElementById('wordCountModal').classList.add('active');
});

document.getElementById('closeModal').addEventListener('click', () => {
    document.getElementById('wordCountModal').classList.remove('active');
});

document.getElementById('wordCountModal').addEventListener('click', (e) => {
    if (e.target.id === 'wordCountModal') {
        document.getElementById('wordCountModal').classList.remove('active');
    }
});

// Fullscreen
document.getElementById('fullscreenBtn').addEventListener('click', () => {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
    } else {
        document.exitFullscreen();
    }
});

// Keyboard shortcuts
editor.addEventListener('keydown', (e) => {
    if (e.ctrlKey || e.metaKey) {
        switch(e.key.toLowerCase()) {
            case 'b':
                e.preventDefault();
                document.execCommand('bold');
                break;
            case 'i':
                e.preventDefault();
                document.execCommand('italic');
                break;
            case 'u':
                e.preventDefault();
                document.execCommand('underline');
                break;
            case 's':
                e.preventDefault();
                saveNote();
                break;
        }
    }
});

// Handle tab key
editor.addEventListener('keydown', (e) => {
    if (e.key === 'Tab') {
        e.preventDefault();
        document.execCommand('insertText', false, '    ');
    }
});
</script>

<script src="guard.js"></script>
    <script src="custom-cursor.js"></script>
    <script src="rightclick.js"></script>
    <script src="panic-key.js"></script>
    <script src="idle-dvd.js"></script>
</body>
</html>